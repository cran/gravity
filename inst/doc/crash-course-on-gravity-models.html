<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Mauricio Vargas" />

<meta name="date" content="2018-11-22" />

<title>A crash course on gravity models</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">A crash course on gravity models</h1>
<h4 class="author"><em>Mauricio Vargas</em></h4>
<h4 class="date"><em>2018-11-22</em></h4>



<div id="basic-model" class="section level1">
<h1>Basic model</h1>
<p>Gravity models in their traditional form are inspired by Newton law of gravitation:</p>
<p><span class="math display">\[
F_{ij}=G\frac{M_{i}M_{j}}{D^{2}_{ij}}.
\]</span></p>
<p>The force <span class="math inline">\(F\)</span> between two bodies <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math inline">\(i \neq j\)</span> is proportional to the masses <span class="math inline">\(M\)</span> of these bodies and inversely proportional to the square of their geographical distance <span class="math inline">\(D\)</span>. <span class="math inline">\(G\)</span> is a constant and as such of no major concern.</p>
<p>The underlying idea of a traditional gravity model, shown for international trade, is equally simple:</p>
<p><span class="math display">\[
X_{ij}=G\frac{Y_{i}^{\beta_{1}}Y_{j}^{\beta_{2}}}{D_{ij}^{\beta_{3}}}.
\]</span></p>
<p>The trade flow <span class="math inline">\(X\)</span> is explained by <span class="math inline">\(Y_{i}\)</span> and <span class="math inline">\(Y_{j}\)</span> that are the masses of the exporting and importing country (e.g. the GDP) and <span class="math inline">\(D_{ij}\)</span> that is the distance between the countries.</p>
<p>Dummy variables such as common borders <span class="math inline">\(contig\)</span> or regional trade agreements <span class="math inline">\(rta\)</span> can be added to the model. Let <span class="math inline">\(t_{ij}\)</span> be the transaction cost defined as:</p>
<p><span class="math display">\[
t_{ij}= D_{ij} \exp(contig_{ij} + rta_{ij})
\]</span></p>
<p>So that the model with friction becomes:</p>
<p><span class="math display">\[
X_{ij}=G\frac{Y_{i}^{\beta_{1}}Y_{j}^{\beta_{2}}}{t_{ij}^{\beta_{3}}}.
\]</span></p>
<p>A logarithmic operator can be applied to form a log-linear model and use a standard estimation methods such as OLS:</p>
<p><span class="math display">\[
\log X_{ij}=\beta_{0}\log G +\beta_{1}\log Y_{i}+\beta_{2}\log Y_{j}+\beta_{3}\log D_{ij}+\beta_{4}contig_{ij}+\beta_{5}rta_{ij}
\]</span></p>
</div>
<div id="trade-barriers-model" class="section level1">
<h1>Trade barriers model</h1>
<p>Provided trade barriers exists, the econometric literature proposes the Multilateral Resistance model defined by the equations:</p>
<p><span class="math display">\[
X_{ij}=\frac{Y_{i}Y_{j}}{Y}\frac{t_{ij}^{1-\sigma}}{P_{j}^{1-\sigma}\Pi_{i}^{1-\sigma}}
\]</span> with <span class="math display">\[
P_{i}^{1-\sigma}=\sum_{j}\frac{t_{ij}^{1-\sigma}}{\Pi_{j}^{1-\sigma}}\frac{Y_{j}}{Y}.
\]</span> and <span class="math display">\[
\Pi_{j}^{1-\sigma}=\sum_{i}\frac{t_{ij}^{1-\sigma}}{P_{i}^{1-\sigma}}\frac{Y_{i}}{Y}
\]</span></p>
<p>Basically the model proposes that the exports <span class="math inline">\(X_{ij}\)</span> from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> are determined by the supply factors in <span class="math inline">\(i\)</span>, <span class="math inline">\(Y_{i}\)</span>, and the demand factors in <span class="math inline">\(j\)</span>, <span class="math inline">\(Y_{j}\)</span>, as well as the transaction costs <span class="math inline">\(t_{ij}\)</span>.</p>
<p>Next to information on bilateral partners <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, information on the rest of the world is included in the gravity model with <span class="math inline">\(Y=\sum_{i} Y_{i}= \sum_{j} Y_{j}\)</span> that represents the worldwide sum of incomes (e.g. the world’s GDP).</p>
<p>In this model <span class="math inline">\(\sigma\)</span> represents the elasticity of substitution between all goods. A key assumption is to take a fixed value <span class="math inline">\(\sigma &gt; 1\)</span> in order to account for the preference for a variation of goods (e.g. in this model goods can be replaced for other similar goods).</p>
<p>The Multilateral Resistance terms are included via the terms <span class="math inline">\(P\)</span>, Inward Multilateral Resistance, and <span class="math inline">\(\Pi\)</span>, Outward Multilateral Resistance. The Inward Multilateral Resistance <span class="math inline">\(P_i\)</span> is a function of the transaction costs of <span class="math inline">\(i\)</span> to all trade partners <span class="math inline">\(j\)</span>. The Outward Multilateral Resistance <span class="math inline">\(\Pi_{j}\)</span> is a function of the transaction costs of <span class="math inline">\(j\)</span> to all trade partners <span class="math inline">\(i\)</span> and their demand.</p>
<p>The Multilateral Resistance terms dependent on each other. Hence, the estimation of structural gravity models becomes complex.</p>
</div>
<div id="model-estimation" class="section level1">
<h1>Model estimation</h1>
<p>To estimate gravity equations you need a square dataset including bilateral flows defined by the argument dependent_variable, a distance measure defined by the argument distance that is the key regressor, and other potential influences (e.g. contiguity and common currency) given as a vector in additional_regressors are required.</p>
<p>Some estimation methods require ISO codes or similar of type character variables to compute particular country effects. Make sure the origin and destination codes are of type “character”.</p>
<p>The rule of thumb for regressors or independent variables consists in:</p>
<ul>
<li>All dummy variables should be of type numeric (0/1).</li>
<li>If an independent variable is defined as a ratio, it should be logged.</li>
</ul>
<p>The user should perform some data cleaning beforehand to remove observations that contain entries that can distort estimates, notwithstanding the functions provided within this package will remove zero flows and distances.</p>
<p>See  for gravity datasets and Stata code for estimating gravity models.</p>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<p>All the examples here are adapted from <span class="citation">Wölwer, Breßlein, and Burgard (2018)</span>. We included some examples that require further explanation as they perform some data transforming and therefore the functions provide a simplification for the end user.</p>
<div id="double-demeaning" class="section level2">
<h2>Double Demeaning</h2>
<p>Double Demeaning, as introduced by <span class="citation">Head and Mayer (2014)</span>, subtracts importer and exporter averages on the left and right hand side of the respective gravity equation, and all unilateral influences including the Multilateral Resistance terms vanish. Therefore, no unilateral variables may be added as independent variables for the estimation.</p>
<p>Our ddm function first logs the dependent variable and the distance variable. Afterwards, the dependent and independent variables are transformed in the following way (exemplary shown for trade flows, <span class="math inline">\(X_{ij}\)</span>):</p>
<p><span class="math display">\[
(\log X_{ij})_{\text{DDM}} = (\log X_{ij}) - (\log X_{ij})_{\text{Origin Mean}} \\- (\log X_{ij})_{\text{Destination Mean}} + (\log X_{ij})_{\text{Mean}}.
\]</span></p>
<p>One subtracts the mean value for the origin country and the mean value for the destination country and adds the overall mean value to the logged trade flows. This procedure is repeated for all dependent and independent variables. The transformed variables are then used for the estimation.</p>
<p>DDM is easily applied, but, as shown in , its very sensitive to missing data.</p>
<p>An example of how to apply the function ddm to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gravity)

fit &lt;-<span class="st"> </span><span class="kw">ddm</span>(
    <span class="dt">dependent_variable =</span> <span class="st">&quot;flow&quot;</span>,
    <span class="dt">distance =</span> <span class="st">&quot;distw&quot;</span>,
    <span class="dt">additional_regressors =</span> <span class="kw">c</span>(<span class="st">&quot;rta&quot;</span>, <span class="st">&quot;comcur&quot;</span>, <span class="st">&quot;contig&quot;</span>),
    <span class="dt">code_origin =</span> <span class="st">&quot;iso_o&quot;</span>,
    <span class="dt">code_destination =</span> <span class="st">&quot;iso_d&quot;</span>,
    <span class="dt">data =</span> gravity_no_zeros
  )

<span class="kw">summary</span>(fit)</code></pre></div>
<pre><code>## 
## Call:
## y_log_ddm ~ dist_log_ddm + rta_ddm + comcur_ddm + contig_ddm + 
##     0
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -20.9411  -1.2268   0.3032   1.5195   8.4538 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## dist_log_ddm -1.60334    0.03312 -48.407   &lt;2e-16 ***
## rta_ddm       0.79727    0.07004  11.383   &lt;2e-16 ***
## comcur_ddm    0.17376    0.14613   1.189    0.234    
## contig_ddm    1.00184    0.11981   8.362   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.318 on 17084 degrees of freedom
## Multiple R-squared:  0.2541, Adjusted R-squared:  0.254 
## F-statistic:  1455 on 4 and 17084 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The package returns lm or glm objects instead of summaries. Doing that allows to use our functions in conjunction with broom or other packages, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)

<span class="kw">tidy</span>(fit)</code></pre></div>
<pre><code>## # A tibble: 4 x 5
##   term         estimate std.error statistic  p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 dist_log_ddm   -1.60     0.0331    -48.4  0.      
## 2 rta_ddm         0.797    0.0700     11.4  6.54e-30
## 3 comcur_ddm      0.174    0.146       1.19 2.34e- 1
## 4 contig_ddm      1.00     0.120       8.36 6.62e-17</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(fit)</code></pre></div>
<pre><code>## # A tibble: 1 x 11
##   r.squared adj.r.squared sigma statistic p.value    df  logLik    AIC
## *     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1     0.254         0.254  2.32     1455.       0     4 -38611. 77232.
## # ... with 3 more variables: BIC &lt;dbl&gt;, deviance &lt;dbl&gt;, df.residual &lt;int&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">augment</span>(fit)</code></pre></div>
<pre><code>## # A tibble: 17,088 x 12
##    y_log_ddm dist_log_ddm rta_ddm comcur_ddm contig_ddm  .fitted .se.fit
##  *     &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1  -0.710         0.540   0.0175    0.0562    -0.0435  -0.885   0.0205 
##  2   0.00279      -0.0201  0.0318    0.0501    -0.00474  0.0616  0.00754
##  3  -0.373         0.154  -0.197    -0.00870   -0.0502  -0.456   0.0126 
##  4  -3.85         -0.758  -0.0408    0.0562    -0.0533   1.14    0.0298 
##  5   0.301         0.223  -0.191    -0.00705   -0.0237  -0.534   0.0111 
##  6  -3.45          0.599  -0.0747   -0.0747    -0.0762  -1.11    0.0176 
##  7   1.80         -0.861   0.0562    0.0562    -0.0152   1.42    0.0276 
##  8  -1.43         -0.0245 -0.127     0.0562    -0.0319  -0.0845  0.0135 
##  9   3.10         -0.0260 -0.0195    0.0562    -0.0426  -0.00683 0.0104 
## 10  -3.88          0.622  -0.0227    0.0562    -0.0486  -1.05    0.0217 
## # ... with 17,078 more rows, and 5 more variables: .resid &lt;dbl&gt;,
## #   .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;, .cooksd &lt;dbl&gt;, .std.resid &lt;dbl&gt;</code></pre>
</div>
<div id="bonus-vetus" class="section level2">
<h2>Bonus Vetus</h2>
<p><span class="citation">S. L. Baier and Bergstrand (2010)</span> suggest a modification of the simple OLS that is easily implemented, allows for comparative statics and yields results close to those of NLS, called Bonus vetus OLS (BVU and BVW). They estimate gravity models in their additive form.</p>
<p>As unilateral income elasticities are assumed, flows are divided by the product of unilateral incomes. The dependent variable for the estimation is therefore <span class="math display">\[\log\left(\frac{y}{inc_{o} \: inc_{d}}\right).\]</span></p>
<p>By applying a Taylor-series expansion and the assumption of symmetrical, bilateral trade costs, they develop a reduced gravity model in which multilateral and worldwide resistance enter exogenously.</p>
<p><span class="citation">S. L. Baier and Bergstrand (2010)</span> distinguish two types of Bonus vetus estimations depending on how the Taylor-series is centered. One method, called BVU, uses simple averages while the other, called BVW, uses GDP weights. Depending on which method is used, the transaction costs are weighted differently. For advantages and disadvantages of both methods see <span class="citation">Scott L. Baier and Bergstrand (2009)</span> and <span class="citation">S. L. Baier and Bergstrand (2010)</span>.</p>
<p>To give an example with simple averages (BVU), distance would be transformed to Multilateral and World Resistance in the following way: <span class="math display">\[
MWR_{ij} = \frac{1}{N}\left(\sum_{i=1}^{N}\log D_{ij} \right)+\frac{1}{N}\left(\sum_{j=1}^{N}\log D_{ij} \right)-\frac{1}{N^{2}}\left(\sum_{i=1}^{N}\sum_{j=1}^{N}\log D_{ij} \right)
\]</span> with <span class="math inline">\(D_{ij}\)</span> denoting the bilateral distance, <span class="math inline">\(N\)</span> the number of countries and <span class="math inline">\((MWR)_{D_{ij}}\)</span> the transformed variable adjusted for multilateral resistances.</p>
<p>When using weighted averages (BVW), the simple averages are replaced by GDP weights. The transformed variables are included as independent variables in the estimation. The resulting equation can be estimated by simple OLS.</p>
<p>An example of how to apply the functions bvu and bvw to an example dataset in gravity and the resulting output is shown in the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit2 &lt;-<span class="st"> </span><span class="kw">bvu</span>(
    <span class="dt">dependent_variable =</span> <span class="st">&quot;flow&quot;</span>,
    <span class="dt">distance =</span> <span class="st">&quot;distw&quot;</span>,
    <span class="dt">additional_regressors =</span> <span class="kw">c</span>(<span class="st">&quot;rta&quot;</span>, <span class="st">&quot;contig&quot;</span>, <span class="st">&quot;comcur&quot;</span>),
    <span class="dt">income_origin =</span> <span class="st">&quot;gdp_o&quot;</span>,
    <span class="dt">income_destination =</span> <span class="st">&quot;gdp_d&quot;</span>,
    <span class="dt">code_origin =</span> <span class="st">&quot;iso_o&quot;</span>,
    <span class="dt">code_destination =</span> <span class="st">&quot;iso_d&quot;</span>,
    <span class="dt">data =</span> gravity_no_zeros
  )

<span class="kw">tidy</span>(fit2)</code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    7.47     0.0192    389.   0.      
## 2 dist_log_mr   -1.69     0.0359    -47.0  0.      
## 3 rta_mr         0.582    0.0793      7.35 2.12e-13
## 4 contig_mr      1.00     0.131       7.62 2.75e-14
## 5 comcur_mr      0.191    0.167       1.14 2.53e- 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(fit2)</code></pre></div>
<pre><code>## # A tibble: 1 x 11
##   r.squared adj.r.squared sigma statistic p.value    df  logLik    AIC
## *     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1     0.229         0.229  2.51     1271.       0     5 -39958. 79928.
## # ... with 3 more variables: BIC &lt;dbl&gt;, deviance &lt;dbl&gt;, df.residual &lt;int&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit3 &lt;-<span class="st"> </span><span class="kw">bvw</span>(
    <span class="dt">dependent_variable =</span> <span class="st">&quot;flow&quot;</span>,
    <span class="dt">distance =</span> <span class="st">&quot;distw&quot;</span>,
    <span class="dt">additional_regressors =</span> <span class="kw">c</span>(<span class="st">&quot;rta&quot;</span>, <span class="st">&quot;comcur&quot;</span>, <span class="st">&quot;contig&quot;</span>),
    <span class="dt">income_origin =</span> <span class="st">&quot;gdp_o&quot;</span>,
    <span class="dt">income_destination =</span> <span class="st">&quot;gdp_d&quot;</span>,
    <span class="dt">code_origin =</span> <span class="st">&quot;iso_o&quot;</span>,
    <span class="dt">code_destination =</span> <span class="st">&quot;iso_d&quot;</span>,
    <span class="dt">data =</span> gravity_no_zeros
  )

<span class="kw">tidy</span>(fit3)</code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    7.26     0.0546    133.   0.       
## 2 dist_log_mr   -0.634    0.0257    -24.7  1.09e-132
## 3 rta_mr         1.31     0.0670     19.5  4.07e- 84
## 4 comcur_mr     -0.896    0.142      -6.31 2.86e- 10
## 5 contig_mr      1.38     0.126      10.9  1.11e- 27</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(fit3)</code></pre></div>
<pre><code>## # A tibble: 1 x 11
##   r.squared adj.r.squared sigma statistic p.value    df  logLik    AIC
## *     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1     0.118         0.118  2.68      574.       0     5 -41106. 82225.
## # ... with 3 more variables: BIC &lt;dbl&gt;, deviance &lt;dbl&gt;, df.residual &lt;int&gt;</code></pre>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p> </p>
<div id="refs" class="references">
<div id="ref-Baier2010">
<p>Baier, S. L., and J. H. Bergstrand. 2010. “The Gravity Model in International Trade: Advances and Applications.” In, edited by Peter A. G. van Bergeijk and StevenEditors Brakman. Cambridge University Press. doi:<a href="https://doi.org/10.1017/CBO9780511762109">10.1017/CBO9780511762109</a>.</p>
</div>
<div id="ref-Baier2009">
<p>Baier, Scott L., and Jeffrey H. Bergstrand. 2009. “Bonus Vetus Ols: A Simple Method for Approximating International Trade-Cost Effects Using the Gravity Equation.” <em>Journal of International Economics</em> 77 (1): 77–85. doi:<a href="https://doi.org/10.1016/j.jinteco.2008.10.004">10.1016/j.jinteco.2008.10.004</a>.</p>
</div>
<div id="ref-Head2014">
<p>Head, Keith, and Thierry Mayer. 2014. “Chapter 3 - Gravity Equations: Workhorse,Toolkit, and Cookbook.” In <em>Handbook of International Economics</em>, edited by Gita Gopinath, Elhanan Helpman, and Kenneth Rogoff, 4:131–95. Handbook of International Economics. Elsevier. doi:<a href="https://doi.org/10.1016/B978-0-444-54314-1.00003-3">10.1016/B978-0-444-54314-1.00003-3</a>.</p>
</div>
<div id="ref-WoelwerBressleinBurgard2018">
<p>Wölwer, Anna-Lena, Martin Breßlein, and Jan Pablo Burgard. 2018. “Gravity Models in R.” <em>Austrian Journal of Statistics</em> 47 (4): 16–35. doi:<a href="https://doi.org/10.17713/ajs.v47i4.688">10.17713/ajs.v47i4.688</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
